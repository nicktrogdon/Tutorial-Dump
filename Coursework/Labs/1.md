### PowerView

1. Run Invishell
	Initiate AMSI bypass if needed
```
C:\AD\Tools\InviShell\RunWithRegistryNonAdmin.bat
```

2. Import PowerView
```
 . C:\AD\Tools\PowerView.ps1
```
3. Enumeration Domain Users
```
Get-DomainUser
```

	denote instances of sameaccountname: Administrator
4. Further refine the Domain User scan
```
Get-DomainUser | select -ExpandProperty samaccountname
```

5. Find member computers in the domain
```
Get-DomainComputer | select -ExpandProperty dnshostname
```

6. Find details on the Domain Admins group
```
Get-DomainGroup -Identity "Domain Admins"
```

7. Determine the members of the Domain Admins group
```
Get-DomainGroupMember -Identity "Domain Admins"
```

8. Determine the members of the Enterprise Admins group (needs to point to root domain)
```
Get-DomainGroupMember -Identity "Enterprise Admins" â€“Domain <corp>.local
```

### AD Module
1. Run Invishell
	Initiate AMSI bypass if needed
```
C:\AD\Tools\InviShell\RunWithRegistryNonAdmin.bat
```

2. Import AD Module
```
Import-Module C:\AD\Tools\ADModule-master\Microsoft.ActiveDirectory.Management.dll
```
```
Import-Module C:\AD\Tools\ADModule-master\ActiveDirectory\ActiveDirectory.psd1
```

3. Enumerate users on current domain
```
Get-ADUser -Filter *
```

4. Further refine the user search
```
Get-ADUser -Filter * -Properties *| select Samaccountname,Description
```

5. List all computers
```
Get-ADComputer -Filter *
```

6. Find details on Domain Admins
```
Get-ADGroupMember -Identity 'Domain Admins'
```

7. Find details on Enterpise Admins
```
Get-ADGroupMember -Identity 'Enterprise Admins' -Server <corp>.local
```